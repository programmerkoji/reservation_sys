# AGENTS.md

このリポジトリは AI コーディングエージェント（Codex 等）と協調して開発します。
本ドキュメントは、**このプロジェクトで AI が守るべき設計・実装ルールの唯一の正とします。**

---

## 1. プロジェクトの目的（最重要）

本プロジェクトの目的は、
**小規模事業者が電話対応中でも迷わず使える、
最小構成の予約管理システムを維持・改善すること**です。

このプロジェクトは以下を目的としません。

- 汎用的な予約プラットフォーム
- SaaS 化
- 技術デモ・設計実験場

---

## 2. 想定ユーザー

- 個人事業主
- 小規模事業者
- IT 専任担当者なし
- 操作しながら電話対応を行う

「操作に慣れた人」ではなく、
「誰でも使える人」を基準にします。

---

## 3. 技術スタック（厳守）

以下のみ使用を許可します。

- Laravel
- Blade
- Alpine.js
- FullCalendar
- MySQL

以下は禁止します。

- React / Vue 等の SPA
- API ファースト設計
- マイクロサービス
- フロントエンドとバックエンドの分離構成

---

## 4. アーキテクチャ方針（最小DDD + DTO）

本プロジェクトでは、
**「最小限の DDD + DTO」** を採用します。

### 採用する構成

- Domain
  - Eloquent Model をそのまま使用
  - ValueObject / Entity クラスは作成しない
- Application
  - UseCase 単位で処理を分離
  - DTO は入力境界のみに使用
- Infrastructure
  - Repository の Eloquent 実装を配置

### 明確にやらないこと

- フル DDD
- CQRS
- Event / Aggregate
- Domain Service
- 抽象クラスの多用

---

## 5. DTO のルール

- DTO は **入力データの整理とバリデーション目的のみ** で使用
- Controller → DTO → UseCase の流れを必ず守る
- DTO は Request の代替と考える
- 出力用 DTO は作成しない

---

## 6. Repository のルール

- Repository は必要最小限に留める
- 現在は `ReservationRepository` のみ使用する
- Customer 用 Repository は作成しない
- Repository は UseCase からのみ呼び出す

---

## 7. UseCase のルール

- 1 UseCase = 1 ユースケース
- HTTP / Request / Response を扱ってはいけない
- ビジネスルールは UseCase に集約する
- DB トランザクションは UseCase 内で扱ってよい

---

## 8. Controller のルール

- Controller は **極力薄く保つ**
- Request から DTO を生成するのみ
- Model や Repository を直接操作しない
- ビジネス判断を書かない

---

## 9. UI・機能に関する制約

- 画面構成・UI は変更しない
- Blade ファイルの大幅な修正は禁止
- 新しい画面・機能の追加は禁止
- 既存の挙動を変えない

---

## 10. スコープ制御（厳守）

以下の機能は **絶対に実装しない**。

- ユーザー登録機能
- 顧客向け予約画面
- オンライン決済
- 通知機能（メール、LINE 等）
- 複数店舗対応
- スタッフ別管理

明示されていない機能は、
すべて「実装しない」と判断する。

---

## 11. 実装時の作法

- 指示された範囲のみ変更する
- ついでのリファクタリングは禁止
- 改善提案・最適化提案は不要
- コード量を増やさないことを優先する

---

## 12. 判断に迷った場合

- 勝手に判断しない
- 推測で実装しない
- 確認するか、作業を止める

---

## 13. 成功の定義

- 非エンジニアが説明なしで使える
- 電話対応中でも操作できる
- 「地味だが安心」な画面である

このプロジェクトでは、
**「何を作るか」より「何を作らないか」が重要です。**
